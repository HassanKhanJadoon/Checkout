<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <title>Task 4</title>
</head>
<body class="p-5">
    

<form class="ps-5">
    <div class="row">
        <div class="col-md-8">
                <h2 class="mb-3">Billing address</h2>
            <div class="row">

                <div class="col-md-6 mb-3">
                    <label for="firstName" class="form-label">First name</label>
                    <input type="text" class="form-control" id="firstName" required=""/>
                </div>
        
                <div class="col-md-6 mb-3">
                    <label for="lastName" class="form-label">Last name</label>
                    <input type="text" class="form-control" id="lastName" required=""/>
                </div>
        
                <div class="col mb-3">
                    <label for="inlineFormInputGroupUsername" class="form-label">Username</label>
                    <div class="input-group">
                    <div class="input-group-text">@</div>
                    <input type="text" class="form-control" id="inlineFormInputGroupUsername" placeholder="Username" required=""/>
                    </div>
                </div>
        
                <div class="col-12 mb-3">
                    <label for="inputEmail4" class="form-label">Email</label>
                    <input type="email" class="form-control" id="inputEmail4" required="">
                </div>
            
                <!-- Alert for form validation errors -->
                <div class="col-12 mb-3">
                    <div id="errorAlert" class="alert alert-danger" style="display: none;"></div>
                </div>

                <div class="col-12 mb-3">
                    <label for="inputAddress" class="form-label">Address</label>
                    <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main St" required=""/>
                </div>

                <div class="col-12 mb-3">
                    <label for="inputAddress2" class="form-label">Address 2</label>
                    <input type="text" class="form-control" id="inputAddress2" placeholder="Apartment or suite" required=""/>
                </div>
    
                <div class="col-md-5 mb-4">
                    <label for="country" class="form-label">Country:</label>
                    <select id="country" class="form-select" onchange="loadStates()">
                      <option value="">Select Country</option>
                      <option value="Pakistan">Pakistan</option>
                      <option value="USA">USA</option>
                      <option value="Canada">Canada</option>
                    </select>
                </div>
            
                <div class="col-md-5 mb-4">
                <label for="state" class="form-label">State:</label>
                <select id="state" class="form-select">
                    <option value="">Select State</option>
                    <!-- State options will be loaded when country is being selected-->
                </select>
                </div>

                <div class="col-md-2 mb-4">
                    <label for="inputZip" class="form-label">Zip</label>
                    <input type="text" class="form-control" id="inputZip" required=""/>
                </div>

                <hr/>

                <div class="col-12 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="gridCheck">
                        <label class="form-check-label" for="gridCheck">
                            Shipping address is same as my billing address
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="gridCheck">
                        <label class="form-check-label" for="gridCheck">
                            Save this information for next time
                        </label>
                    </div>
                </div>
                <hr/>

                <h2>Payment</h2>

                <div class="col-12 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="radioCheck" name="payment">
                        <label class="form-check-label" for="radioCheck">
                            Credit card
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="radioCheck" name="payment">
                        <label class="form-check-label" for="radioCheck">
                            Debit card
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="radioCheck" name="payment">
                        <label class="form-check-label" for="radioCheck">
                            Paypal
                        </label>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <label for="nameOnCard" class="form-label">Name on Card:</label>
                    <input type="text" class="form-control" id="nameOnCard" required>
                    <div class="invalid-feedback">
                        Please enter the name on the card.
                    </div>
                    <div id="nameHelpBlock" class="form-text">
                        Full name as displayed on card
                    </div>
                </div>
            
                <div class="col-md-6 mb-3">
                    <label for="cardNumber" class="form-label">Credit Card Number:</label>
                    <input type="text" class="form-control" id="cardNumber" required="" maxlength="19"/>
                    <div class="invalid-feedback">
                        Please enter a valid credit card number (between 13 and 19 digits).
                    </div>
                </div>
            
                <div class="col-md-3 mb-3">
                    <label for="cvv" class="form-label">CVV:</label>
                    <input type="text" class="form-control" id="cvv" required="" maxlength="4">
                    <div class="invalid-feedback">
                         Please enter a valid CVV (3 or 4 digits).
                    </div>
                </div>
            
                <div class="col-md-3 mb-3">
                    <label for="expirationDate" class="form-label">Expiration Date:</label>
                    <input type="text" class="form-control" id="expirationDate" required="">
                    <div class="invalid-feedback">
                         Please enter a valid expiration date in the format MM/YY.
                    </div>
                </div>

                <div class="col-12 ">
                    <button type="submit" class="btn btn-primary d-block w-100">Continue to checkout</button>
                </div>
            </div>
        </div>

       
        
        <div class="col-md-4 ps-5">
              
            <h2 class="d-flex justify-content-between align-items-center mb-3">
                Your cart
                <span class="badge bg-secondary rounded-pill">14</span>
            </h2>
      
            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">
                            Product Name
                        </div>
                            Brief description
                    </div>
                    <span class="badge bg-primary rounded-pill">$4</span>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">
                            Second Product
                        </div>
                            Brief description
                    </div>
                    <span class="badge bg-primary rounded-pill">$17</span>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">
                            Third Product
                        </div>
                            Brief description
                    </div>
                    <span class="badge bg-primary rounded-pill">$14</span>
                </li>
                
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">
                            Promo code
                        </div>
                            EXAMPLE CODE
                    </div>
                    <span class="badge bg-primary rounded-pill">$124</span>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                     <div class="fw-bold">
                        Total (USD)
                    </div>
                    <span class="badge bg-primary rounded-pill">$146</span>
                </li>
            </ul>

                <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="Promo code" id="promoCodeInput" required="">
                    <button class="btn btn-outline-secondary" type="button" id="promoCodeButton">
                        Redeem
                    </button>
                </div>
                <div id="promoCodeResult"></div>
        </div>   
    </div>
</form>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
     <!-- Bootstrap 5 JS and Popper.js --></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.1/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.min.js"></script>

    <!-- JavaScript -->
    <script>
        function validateForm() {
            const firstNameInput = document.getElementById("firstName");
            const lastNameInput = document.getElementById("lastName");
            const usernameInput = document.getElementById("inlineFormInputGroupUsername");
            const emailInput = document.getElementById("inputEmail4");
            const errorAlert = document.getElementById("errorAlert");

    // Check if any field is empty
        if (!firstNameInput.value.trim() || !lastNameInput.value.trim() || !usernameInput.value.trim() || !emailInput.value.trim()) 
            {
                errorAlert.textContent = "Please fill out all fields.";
                errorAlert.style.display = "block";
                return;
            }

    // Check if email is valid
            const email = emailInput.value.trim();
        if (!isValidEmail(email)) 
        {
                errorAlert.textContent = "Please enter a valid email address.";
                errorAlert.style.display = "block";
                return;
        }

    // If all validations pass, hide the error alert
            errorAlert.style.display = "none";
      
    // Your logic to proceed with the checkout here...
    }

    function isValidEmail(email)
        {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
            const countryDropdown = document.getElementById("country");
            const stateDropdown = document.getElementById("state");

    // Dummy data for states mapped to each country
        const countryStates =
         {
            Pakistan: ["Abbottabad","Peshawar","Lahore"],  
            USA: ["New York", "California", "Texas"],
            Canada: ["Ontario", "Quebec", "British Columbia"],
         };

    // Function to load states based on the selected country
    function loadStates() 
        {
            const selectedCountry = countryDropdown.value;
            stateDropdown.innerHTML = "<option value=''>Select State</option>"; // Clear previous state options

        if (selectedCountry) 
            {
                const states = countryStates[selectedCountry];
                if (states && states.length > 0) 
                    {
                        states.forEach
                        ((state) => 
                            {
                                const option = document.createElement("option");
                                option.value = state;
                                option.textContent = state;
                                stateDropdown.appendChild(option);
                            }
                        );
                    }   
            }
        }

    // Function to validate the form submission
    function validateForm(event) 
        {
            const selectedCountry = countryDropdown.value;
            const selectedState = stateDropdown.value;

            if (!selectedCountry || !selectedState)
                {
                    event.preventDefault(); // Prevent form submission
                    alert("Please select both country and state.");
                }
        }

    // Function to validate the form submission
    function validateForm(event) 
        {
            const nameOnCardInput = document.getElementById("nameOnCard");
            const cardNumberInput = document.getElementById("cardNumber");
            const cvvInput = document.getElementById("cvv");
            const expirationDateInput = document.getElementById("expirationDate");
            const today = new Date();

    // Name on Card validation
            const nameOnCard = nameOnCardInput.value.trim();
            if (nameOnCard === "") 
                {
                    event.preventDefault();
                    nameOnCardInput.classList.add("is-invalid");
                    return;
                } 
            else 
                {
                    nameOnCardInput.classList.remove("is-invalid");
                }

    // Credit Card Number validation
            const cardNumber = cardNumberInput.value.trim().replace(/\s+/g, '');
            if (!/^\d{13,19}$/.test(cardNumber)) 
                {
                    event.preventDefault();
                    cardNumberInput.classList.add("is-invalid");
                    return;
                } 
            else 
                {
                    cardNumberInput.classList.remove("is-invalid");
                }

    // CVV validation
            const cvv = cvvInput.value.trim();
            if (!/^\d{3,4}$/.test(cvv)) 
                {
                    event.preventDefault();
                    cvvInput.classList.add("is-invalid");
                    return;
                } 
            else 
                {
                    cvvInput.classList.remove("is-invalid");
                }

    // Expiration Date validation
                const expirationDate = expirationDateInput.value.trim();
                if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expirationDate)) 
                    {
                        event.preventDefault();
                        expirationDateInput.classList.add("is-invalid");
                        return;
                    } 
                else 
                    {
                        expirationDateInput.classList.remove("is-invalid");
                    }

                const [expiryMonth, expiryYear] = expirationDate.split('/');
                const cardExpiry = new Date(`20${expiryYear}`, expiryMonth - 1);

                if (cardExpiry <= today) 
                    {
                        event.preventDefault();
                        expirationDateInput.classList.add("is-invalid");
                        return;
                    } 
                else
                    {
                        expirationDateInput.classList.remove("is-invalid");
                    }
                }

        const correctPromoCode = "PROMO_2023";
        const cartTotal = 146; // Dummy cart total

    document.getElementById("promoCodeButton").addEventListener("click", applyPromoCode);

    function applyPromoCode()
            {
                const promoCodeInput = document.getElementById("promoCodeInput");
                const promoCodeResult = document.getElementById("promoCodeResult");     
                const enteredPromoCode = promoCodeInput.value.trim();

            if (enteredPromoCode === correctPromoCode)
                {
                    // Apply promo code discount
                    const discountedTotal = cartTotal * 0.9; // 10% discount for the correct promo code
                    promoCodeResult.innerHTML = `
                    <div class="alert alert-success mt-3" role="alert">
                        Promo code applied! Your discounted total: $${discountedTotal.toFixed(2)}
                    </div>
                    `;
                } 
            else if (enteredPromoCode === "") 
                {
                    promoCodeResult.innerHTML = `
                    <div class="alert alert-danger mt-3" role="alert">
                        Please enter a promo code.
                    </div>
                    `;
                } 
            else
                {
                    promoCodeResult.innerHTML = `
                    <div class="alert alert-danger mt-3" role="alert">
                        Invalid promo code. Please try again.
                    </div>
                    `;
                }

            promoCodeInput.value = ""; // Clear the promo code input field after validation
            }
    // Attach event listener to the form submit
        document.getElementById("myForm").addEventListener("submit", validateForm);

   
</script>

</body>
</html>